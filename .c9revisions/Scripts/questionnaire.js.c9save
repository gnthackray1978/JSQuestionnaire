{"ts":1357165044802,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"﻿var JSMaster, QryStrUtils, AncUtils;\n\n \n\n$(document).bind(\"pageinit\", function() {\n    var questionnaire = new Questionnaire();\n    questionnaire.init();\n});\n\nvar Questionnaire = function () {\n    this.selectedcategory = '';\n    this.testcategories = [];\n    this.questionset = [];\n\n    this.qryStrUtils = new QryStrUtils();\n    this.ancUtils = new AncUtils();\n    this.currentQuestionIdx = 0;\n\n};\n\n\n\nQuestionnaire.prototype = {\n\n    init: function () {\n\n\n\n        var finished = function (result) {\n            var headersection = '';\n            var rows = result.split('\\x0A');\n            var idx = 1;\n            while (idx < rows.length) {\n                var cols = rows[idx].split(',');\n\n                this.testcategories.push(cols[2]);\n                idx++;\n            }\n            this.testcategories = this.testcategories.RemoveDupes();\n\n            if (this.testcategories.length > 0 && this.testcategories[0] != undefined) {\n                this.processSelect(this.testcategories[0]);\n                this.createquestionset();\n            }\n\n\n        };\n\n        var aburl = this.ancUtils.getHost() + '/HtmlPages/tests/questions.csv';\n\n        $.ajax({\n            url: aburl,\n            data: \"query=search_terms\",\n            success: $.proxy(finished, this)\n        });\n\n        $('#main').bind(\"vclick\",\n        $.proxy(\n        function () {\n            var panels = new Panels();\n            panels.masterShowTab(1);\n            this.createquestionset();\n        }, this));\n\n        $('#select').bind(\"vclick\",\n        $.proxy(\n        function () {\n            var panels = new Panels();\n            panels.masterShowTab(2);\n            this.listtests();\n        }, this));\n\n        $('#next').bind(\"vclick\",\n        $.proxy(\n        function () {\n            this.displayQuestion(1);\n        }, this));\n\n        $('#prev').bind(\"vclick\",\n        $.proxy(\n        function () {\n            this.displayQuestion(-1);\n        }, this));\n    },\n\n    listtests: function () {\n        var cats = '';\n        var selectEvents = [];\n        var idx = 0;\n        while (idx < this.testcategories.length) {\n            if (this.testcategories[idx] != undefined) {\n                cats += '<a id= \"s' + idx + '\" href=\"index.html\" data-role=\"button\" data-theme=\"b\" data-corners=\"true\" data-shadow=\"true\" data-iconshadow=\"true\" data-wrapperels=\"span\" class=\"ui-btn ui-shadow ui-btn-corner-all ui-btn-up-b\"><span class=\"ui-btn-inner ui-btn-corner-all\"><span class=\"ui-btn-text\">' + this.testcategories[idx] + '</span></span></a>';\n\n                selectEvents.push({ key: 's' + idx, value: this.testcategories[idx] });\n            }\n            idx++;\n        }\n        this.ancUtils.addlinks(selectEvents, this.processSelect, this);\n        $('#categories').html(cats);\n    },\n\n    processSelect: function (cat) {\n        this.selectedcategory = cat;\n        $('#title').html(cat);\n    },\n\n    createquestionset: function () {\n\n        var finished = function (result) {\n            var headersection = '';\n            var rows = result.split('\\x0A');\n            var idx = 1;\n            this.questionset = [];\n            while (idx < rows.length) {\n                var cols = rows[idx].split(',');\n                if (cols[2] == this.selectedcategory) {\n                    this.questionset.push({ question: cols[0], answer: cols[1] });\n                }\n                idx++;\n            }\n            this.displayQuestion(0);\n        };\n\n        $.ajax({\n            url: this.ancUtils.getHost() + '/HtmlPages/tests/questions.csv',\n            data: \"query=search_terms\",\n            success: $.proxy(finished, this)\n        });\n    },\n\n    displayQuestion: function (pos) {\n        var content = '';\n        // if (this.currentQuestionIdx == 0 && pos == -1 ) pos = 0;\n\n        switch (pos) {\n            case 1:\n                if (this.questionset.length - 1 > this.currentQuestionIdx)\n                    this.currentQuestionIdx++;\n                break;\n            case -1:\n                if (this.currentQuestionIdx > 0)\n                    this.currentQuestionIdx--;\n                break;\n            default:\n                this.currentQuestionIdx = 0;\n        }\n\n        if (this.questionset != undefined && this.questionset.length > 0) {\n            $('#count').html(this.currentQuestionIdx + 1 + ' of ' + this.questionset.length);\n\n\n            var items = this.questionset[this.currentQuestionIdx].answer.split('|');\n\n            if (items.length > 1) {\n                var idx = 1;\n                content = '<div id=\"rqs\"><fieldset id = \"t1\" data-role=\"controlgroup\"><legend>' + this.questionset[this.currentQuestionIdx].question + '</legend>';\n\n                while (idx < items.length) {\n\n                    var chkid = 'radio-choice-' + idx;\n\n                    if (idx == 1)\n                        content += '<input type=\"radio\" name=\"radio-choice\" id=\"' + chkid + '\" value=\"choice-' + idx + '\" checked=\"checked\" /><label for=\"' + chkid + '\">' + items[idx - 1] + '</label>';\n                    else\n                        content += '<input type=\"radio\" name=\"radio-choice\" id=\"' + chkid + '\" value=\"choice-' + idx + '\" /><label for=\"' + chkid + '\">' + items[idx - 1] + '</label>';\n\n                    idx++;\n                }\n\n                content += '</fieldset></div>';\n                $(\"#answer\").removeClass(\"displayPanel\").addClass(\"hidePanel\");\n            }\n            else {\n                content = this.questionset[this.currentQuestionIdx].question;\n                $(\"#answer\").removeClass(\"hidePanel\").addClass(\"displayPanel\");\n            }\n\n        }\n        else {\n            content = 'no questions';\n            $(\"#answer\").removeClass(\"displayPanel\").addClass(\"hidePanel\");\n        }\n\n        $('#mainbody').html(content);\n        //how long did it take to work out i needed to call this - on a containing div not the content!!\n        $(\"#rqs\").trigger('create');\n       \n    }\n\n\n}\n\n\n\n\n\n\n\n\n\n            //<fieldset data-role=\"controlgroup\">\n            //\t<legend>Choose a pet:</legend>\n            //     \t<input type=\"radio\" name=\"radio-choice\" id=\"radio-choice-1\" value=\"choice-1\" checked=\"checked\" />\n            //     \t<label for=\"radio-choice-1\">Cat</label>\n\n            //     \t<input type=\"radio\" name=\"radio-choice\" id=\"radio-choice-2\" value=\"choice-2\"  />\n            //     \t<label for=\"radio-choice-2\">Dog</label>\n\n            //     \t<input type=\"radio\" name=\"radio-choice\" id=\"radio-choice-3\" value=\"choice-3\"  />\n            //     \t<label for=\"radio-choice-3\">Hamster</label>\n\n            //     \t<input type=\"radio\" name=\"radio-choice\" id=\"radio-choice-4\" value=\"choice-4\"  />\n            //     \t<label for=\"radio-choice-4\">Lizard</label>\n            //</fieldset>\n"]],"start1":0,"start2":0,"length1":0,"length2":6763}]],"length":6763}
{"contributors":[],"silentsave":false,"ts":1357250617283,"patch":[[{"diffs":[[-1,"﻿"],[0,"var "]],"start1":0,"start2":0,"length1":5,"length2":4},{"diffs":[[0,"tHost() + '/"],[-1,"HtmlPages/test"],[1,"Question"],[0,"s/questions."]],"start1":1109,"start2":1109,"length1":38,"length2":32}]],"length":6756,"saved":false}
{"ts":1357250825574,"patch":[[{"diffs":[[0,"+ '/"],[-1,"HtmlPages/test"],[1,"Question"],[0,"s/qu"]],"start1":3511,"start2":3511,"length1":22,"length2":16}]],"length":6750,"saved":false}
{"contributors":[],"silentsave":false,"ts":1359553691583,"patch":[[{"diffs":[[0,"gories[0] !="],[1,"="],[0," undefined) "]],"start1":917,"start2":917,"length1":24,"length2":25}]],"length":6751,"saved":false}
{"ts":1359553706398,"patch":[[{"diffs":[[0,"var "],[-1,"JSMaster"],[1,"Panels"],[0,", Qr"]],"start1":0,"start2":0,"length1":16,"length2":14},{"diffs":[[0,"[idx] !="],[1,"="],[0," undefin"]],"start1":2152,"start2":2152,"length1":16,"length2":17}]],"length":6750,"saved":false}
{"ts":1359553713499,"patch":[[{"diffs":[[0,"esult) {\n       "],[1,"//"],[0,"     var headers"]],"start1":2971,"start2":2971,"length1":32,"length2":34}]],"length":6752,"saved":false}
{"ts":1359553720916,"patch":[[{"diffs":[[0,"{\n          "],[1,"//"],[0,"  var header"]],"start1":496,"start2":496,"length1":24,"length2":26}]],"length":6754,"saved":false}
{"ts":1359553861042,"patch":[[{"diffs":[[0,"onset !="],[1,"="],[0," undefin"]],"start1":4211,"start2":4211,"length1":16,"length2":17}]],"length":6755,"saved":false}
{"contributors":[],"silentsave":false,"ts":1360248115868,"patch":[[{"diffs":[[0,"split('|');\n"],[1,"            \n            if(this.questionset[this.currentQuestionIdx].question.indexOf(\".jpg\") === -1)\n            {\n                \n                \n            }\n\n"],[0,"\n           "]],"start1":4434,"start2":4434,"length1":24,"length2":190}]],"length":6921,"saved":false}
{"ts":1360257209445,"patch":[[{"diffs":[[0,"= 0;\n        }\n\n"],[1,"\n\n      \n        \n        \n"],[0,"        if (this"]],"start1":4172,"start2":4172,"length1":32,"length2":59},{"diffs":[[0,"h > 0) {"],[-1,"\n"],[0,"        "]],"start1":4283,"start2":4283,"length1":17,"length2":16},{"diffs":[[0,"    "],[-1,"$('#count').html(this.currentQuestionIdx + 1 + ' of ' + this.questionset.length);\n\n"],[1,"        "],[0,"\n   "]],"start1":4299,"start2":4299,"length1":91,"length2":16},{"diffs":[[0,"|');"],[-1,"\n            \n            if"],[1,"                     \n            var questionType =0; // default option\n            questionType = items.length !== 0 ? 1 : questionType;\n            questionType = "],[0,"(thi"]],"start1":4392,"start2":4392,"length1":36,"length2":174},{"diffs":[[0," === -1)"],[1," ? 2 : questionType;"],[0,"\n       "]],"start1":4629,"start2":4629,"length1":16,"length2":36},{"diffs":[[0,"        "],[-1,"{\n"],[0,"        "]],"start1":4662,"start2":4662,"length1":18,"length2":16},{"diffs":[[0,"    "],[-1,"    \n            }\n\n\n            if (items.length > 1) {\n"],[1,"switch(questionType )\n            {\n                case 0:\n                    content = this.questionset[this.currentQuestionIdx].question;\n                    $(\"#answer\").removeClass(\"hidePanel\").addClass(\"displayPanel\");\n                    break;\n                case 1:\n    "],[0,"    "]],"start1":4695,"start2":4695,"length1":65,"length2":289},{"diffs":[[0,"   var idx = 1;\n"],[1,"    "],[0,"                "]],"start1":4993,"start2":4993,"length1":32,"length2":36},{"diffs":[[0,"egend>';"],[-1,"\n\n"],[1,"                    \n    "],[0,"        "]],"start1":5168,"start2":5168,"length1":18,"length2":41},{"diffs":[[0,"ength) {"],[-1,"\n\n"],[1,"    \n    "],[0,"        "]],"start1":5237,"start2":5237,"length1":18,"length2":25},{"diffs":[[0,"' + idx;"],[-1,"\n\n"],[1,"    \n    "],[0,"        "]],"start1":5300,"start2":5300,"length1":18,"length2":25},{"diffs":[[0,"                "],[1,"   "],[1," "],[0,"content += '<inp"]],"start1":5359,"start2":5359,"length1":32,"length2":36},{"diffs":[[0,"            "],[1,"    "],[0,"else\n       "]],"start1":5565,"start2":5565,"length1":24,"length2":28},{"diffs":[[0,"                "],[1,"  "],[1,"  "],[0,"content += '<inp"]],"start1":5594,"start2":5594,"length1":32,"length2":36},{"diffs":[[0,"label>';"],[-1,"\n\n"],[1,"    \n    "],[0,"        "]],"start1":5765,"start2":5765,"length1":18,"length2":25},{"diffs":[[0,"                "],[-1,"}\n\n"],[1,"    }    \n    "],[0,"                "]],"start1":5809,"start2":5809,"length1":35,"length2":46},{"diffs":[[0,"et></div>';\n"],[1,"    "],[0,"            "]],"start1":5875,"start2":5875,"length1":24,"length2":28},{"diffs":[[0,"    "],[-1,"}\n            else {\n     "],[1,"        break;\n                case 2:\n\n                    break;\n                \n            }\n\n"],[0,"    "]],"start1":5979,"start2":5979,"length1":34,"length2":107},{"diffs":[[0,"    "],[1," $('#"],[0,"co"],[1,"u"],[0,"nt"],[-1,"ent = this.questionset[this.currentQuestionIdx].question;\n                $(\"#answer\").removeClass(\"hidePanel\").addClass(\"displayPanel\");\n            }\n"],[1,"').html(this.currentQuestionIdx + 1 + ' of ' + this.questionset.length);"],[0,"\n   "]],"start1":6089,"start2":6089,"length1":164,"length2":90},{"diffs":[[0,"nel\");\n        }"],[-1,""],[0,""],[1,"\n\n\n\n\n"],[0,"\n\n        $('#ma"]],"start1":6308,"start2":6308,"length1":32,"length2":37}]],"length":7331,"saved":false}
{"ts":1360257682483,"patch":[[{"diffs":[[0," }\n\n"],[-1,"\n\n      \n        \n        \n"],[0,"    "]],"start1":4184,"start2":4184,"length1":35,"length2":8},{"diffs":[[0," case 2:"],[-1,"\n"],[1,"                    \n                    $(\"#sourceid\").attr(\"src\", this.questionset[this.currentQuestionIdx].question);"],[0,"\n       "]],"start1":5986,"start2":5986,"length1":17,"length2":136}]],"length":7423,"saved":false}
{"contributors":[],"silentsave":false,"ts":1371070794491,"patch":[[{"diffs":[[1,"/*\nre-work as follows\n\nchange order of csv so category is first\n\neg category,answer,category\n\n\n\n*/\n\n\n\n\n\n\n\n"],[0,"var Panels, "]],"start1":0,"start2":0,"length1":12,"length2":118},{"diffs":[[0,"Utils;\n\n"],[-1," \n"],[0,"\n$(docum"]],"start1":134,"start2":134,"length1":18,"length2":16},{"diffs":[[0,"    "],[-1,"  //  var headersection = '';"],[0,"\n   "]],"start1":606,"start2":606,"length1":37,"length2":8},{"diffs":[[0,"sh(cols["],[-1,"2"],[1,"0"],[0,"]);\n    "]],"start1":809,"start2":809,"length1":17,"length2":17},{"diffs":[[0,";\n            }\n"],[1,"            //get categories in test\n"],[0,"            this"]],"start1":843,"start2":843,"length1":32,"length2":69},{"diffs":[[0,"});\n    },\n\n"],[1,"\n\n\n"],[0,"    displayQ"]],"start1":3750,"start2":3750,"length1":24,"length2":27},{"diffs":[[0,"('|');  "],[-1,"       "],[1,"\n"],[0,"        "]],"start1":4478,"start2":4478,"length1":23,"length2":17},{"diffs":[[0,"gth "],[-1,"!== 0"],[1,"> 1"],[0," ? 1"]],"start1":4587,"start2":4587,"length1":13,"length2":11},{"diffs":[[0,"\".jpg\") "],[-1,"="],[1,"!"],[0,"== -1) ?"]],"start1":4702,"start2":4702,"length1":17,"length2":17}]],"length":7530,"saved":false}
{"ts":1371070838606,"patch":[[{"diffs":[[0,"f (cols["],[-1,"2"],[1,"0"],[0,"] == thi"]],"start1":3343,"start2":3343,"length1":17,"length2":17},{"diffs":[[0,"n: cols["],[-1,"0"],[1,"1"],[0,"], answe"]],"start1":3433,"start2":3433,"length1":17,"length2":17},{"diffs":[[0,"r: cols["],[-1,"1"],[1,"2"],[0,"] });\n  "]],"start1":3450,"start2":3450,"length1":17,"length2":17}]],"length":7530,"saved":false}
{"ts":1371072114177,"patch":[[{"diffs":[[0,"                "],[1,"\n                    if(cols.length  > 3){\n                        var colIdx = 2;\n                        \n                        while(colIdx < cols.length){\n                            \n                            \n                            colIdx++;\n                        }\n                    }\n                    else\n                    {\n                        "],[0,"this.questionset"]],"start1":3386,"start2":3386,"length1":32,"length2":408},{"diffs":[[0,"cols[2] });\n"],[1,"                    }\n"],[0,"            "]],"start1":3829,"start2":3829,"length1":24,"length2":46}]],"length":7928,"saved":false}
{"ts":1371072266187,"patch":[[{"diffs":[[0,"                "],[1,"var answer ='';"],[0,"\n               "]],"start1":3493,"start2":3493,"length1":32,"length2":47},{"diffs":[[0,"                "],[1,"answer += '|' + cols[colIdx];"],[0,"\n               "]],"start1":3619,"start2":3619,"length1":32,"length2":61}]],"length":7972,"saved":false}
{"ts":1371072466067,"patch":[[{"diffs":[[0,"              }\n"],[1,"                        \n                        this.questionset.push({ question: cols[1], answer: answer});\n"],[0,"                "]],"start1":3713,"start2":3713,"length1":32,"length2":142}]],"length":8082,"saved":false}
{"ts":1371072759180,"patch":[[{"diffs":[[0,"r +="],[-1," '|' +"],[0," col"]],"start1":3640,"start2":3640,"length1":14,"length2":8},{"diffs":[[0,"[colIdx]"],[1," +'|' "],[0,";\n      "]],"start1":3649,"start2":3649,"length1":16,"length2":22}]],"length":8082,"saved":false}
{"ts":1371073034000,"patch":[[{"diffs":[[0,"olIdx = "],[-1,"2"],[1,"3"],[0,";\n      "]],"start1":3474,"start2":3474,"length1":17,"length2":17}]],"length":8082,"saved":false}
{"ts":1371309505109,"patch":[[{"diffs":[[0," option\n"],[1,"            \n            //question is multiple choice\n"],[0,"        "]],"start1":5095,"start2":5095,"length1":16,"length2":71},{"diffs":[[0,"nType = "],[1,"("],[0,"items.le"]],"start1":5177,"start2":5177,"length1":16,"length2":17},{"diffs":[[0,"gth > 1 "],[1,"&& items[0] !='MA')"],[0,"? 1 : qu"]],"start1":5195,"start2":5195,"length1":16,"length2":35},{"diffs":[[0,": questionType;\n"],[1,"            \n            \n            //question is multiple answers\n            \n            \n            \n            //question is a image\n"],[0,"            ques"]],"start1":5226,"start2":5226,"length1":32,"length2":174},{"diffs":[[0,"               \n"],[1,"                            \n                            \n                            \n"],[0,"            swit"]],"start1":5520,"start2":5520,"length1":32,"length2":119}]],"length":8386,"saved":false}
{"ts":1371309561310,"patch":[[{"diffs":[[0,"ers\n            "],[1,"questionType = (items.length > 1 && items[0] =='MA')? 3 : questionType;"],[0,"\n            \n  "]],"start1":5307,"start2":5307,"length1":32,"length2":103}]],"length":8457,"saved":false}
{"ts":1371309582577,"patch":[[{"diffs":[[0,"         break;\n"],[1,"                    \n                case 0:\n                    content = this.questionset[this.currentQuestionIdx].question;\n                    $(\"#answer\").removeClass(\"hidePanel\").addClass(\"displayPanel\");\n                    break;    \n                    \n                    \n"],[0,"                "]],"start1":7160,"start2":7160,"length1":32,"length2":316}]],"length":8741,"saved":false}
{"ts":1371309592893,"patch":[[{"diffs":[[0,"           case "],[-1,"0"],[1,"3"],[0,":\n              "]],"start1":7202,"start2":7202,"length1":33,"length2":33}]],"length":8741,"saved":false}
